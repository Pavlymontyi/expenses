<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Главная страница</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
</head>
<body>

<table border="1" cellpadding="5" cellspacing="0">
    <caption>Вклады</caption>
    <tr valign="top" align="center">
        <td th:each="card: ${cards}"
            th:colspan="${card.getDeposits().size()}"
            align="left">
            <div th:text="${card.getOwner().name}"/>
            <div th:text="${card.getOwner().name}"/>
        </td>
    </tr>
    <tr valign="top" align="center">
        <td th:each="card: ${cards}"
            th:colspan="${card.getDeposits().size()}"
            align="left">
            <div>
                <table>
                    <tr>
                        <td>Информация по карте</td>
                        <td th:text="${card.getShortInfo()}"/>
                    </tr>
                    <tr>
                        <td>Сумма ДС по всем вкладам на карте</td>
                        <td th:text="${#numbers.formatDecimal(card.getTotal()/1000,0,3)}"/>
                    </tr>
                    <tr>
                        <td>Ожидаемые проценты по всем вкладам</td>
                        <td th:text="${#numbers.formatDecimal(card.getRevenue()/1000,0,3)}"/>
                    </tr>
                    <tr>
                        <td>Еще можно положить на данную карту</td>
                        <td th:text="${#numbers.formatDecimal(card.getFreeSpace()/1000,0,3)}"/>
                    </tr>
                </table>
            </div>
        </td>
    </tr>

    <tr>
        <th align="center" th:each="deposit: ${deposits}" th:text="${deposit.getInfo()}"/>
    </tr>
    <tr valign="top" >
        <td th:each="deposit: ${deposits}">
            <table cellspacing="5">
                <tr>
                    <td>Дата</td>
                    <td>Сумма</td>
                    <td>Чье</td>
                    <td>Проценты</td>
                    <td>Итог</td>
                </tr>
                <tr th:each="income: ${deposit.incomes}">
                    <td th:text="${income.date}"/>
                    <td th:text="${income.value}"/>
                    <td th:text="${income.owner.name}"/>
                    <td th:text="${#numbers.formatDecimal(income.getRevenue(),2,2)}" th:title="${income.getRevenueClarification()}"/>
                    <td th:text="${#numbers.formatDecimal(income.calculateTotal(),2,2)}"/>
                </tr>
                <tr valign="bottom">
                    <td><b>Итог</b></td>
                    <td><b th:text="${#aggregates.sum(deposit.incomes.![value])}"/></td>
                    <td></td>
                    <td><b th:text="${#numbers.formatDecimal(#aggregates.sum(deposit.incomes.![getRevenue()]), 2,2)}" /></td>
                    <td><b th:text="${#numbers.formatDecimal(#aggregates.sum(deposit.incomes.![getRevenue()]), 2,2)}" /></td>
                </tr>
            </table>
        </td>

    </tr>

</table>

<br/>

<!--<table border="1" cellpadding="5" cellspacing="0">-->
<!--    <caption>Итоги</caption>-->
<!--    <tr valign="top" align="center">-->
<!--        <td th:each="person: ${persons}"-->
<!--            align="center"-->
<!--            th:text="${person"/>-->
<!--    </tr>-->
<!--</table>-->

</body>
</html>